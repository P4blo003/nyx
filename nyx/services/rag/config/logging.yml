# ==========================================================================================
# Author: Pablo González García.
# Created: 17/12/2025
# Last edited: 17/12/2025
# ==========================================================================================


# ==============================
# CORE
# ==============================

# Version.
version: 1
# When True, existing loggers are disabled when his configurations is loaded.
# Set to false to preserve loggers configured elsewhere in the application.
disable_existing_loggers: false


# ==============================
# FORMATTERS
# ==============================

formatters:
  # Console-optimized formatter with minimal fields for readability.
  # Suitable for development and production monitoring.
  simple:
    format: "%(asctime)s | %(levelname)s | %(message)s"
    datefmt: "%d/%m/%Y %H:%M:%S"

  # Standard formatter that includes the logger name for context.
  # Recommended for most file-based logging scenarios.
  standard:
    format: "%(asctime)s | %(levelname)s | %(name)s | %(message)s"
    datefmt: "%d/%m/%Y %H:%M:%S"
  
  # Debug formatter with complete context including filename and line number.
  # Use for error logs and debugging where location information is critical.
  detailed:
    format: "%(asctime)s | %(levelname)s | %(name)s | %(filename)s:%(lineno)d | %(message)s"
    datefmt: "%d/%m/%Y %H:%M:%S"


# ==============================
# HANDLERS
# ==============================

handlers:
  # Primary console output for real-time application monitoring.
  # Streams to stdout with simple formatting for human readability.
  console_handler:
    class: logging.StreamHandler
    level: DEBUG
    formatter: simple
    stream: ext://sys.stdout

  # Dedicated console handler for Uvicorn web server logs.
  # Allows separate configuration from application logs.
  uvicorn_console_handler:
    class: logging.StreamHandler
    level: DEBUG
    formatter: simple
    stream: ext://sys.stdout

  # Rotating file handler for audit and business event logging.
  # Captures INFO and above for compliance, monitoring, and analytics.
  # Files rotate at 10 MB with 10 Backups files retained.
  audit_file_handler:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: standard
    filename: "logs/audit.log"
    maxBytes: 10485760          # 10MB rotation threshold.
    backupCount: 10             # Number of backup files to retain.
    encoding: "utf-8"

  # Rotating file handler for error and critical event logging.
  # Captures only ERROR and CRITICAL levels with detailed context.
  # Used fro debugging production issues and error analytics.
  error_file_handler:
    class: logging.handlers.RotatingFileHandler
    level: ERROR
    formatter: detailed
    filename: "logs/errors.log"
    maxBytes: 10485760          # 10MB rotation threshold.
    backupCount: 10             # Number of backup files to retain.
    encoding: "utf-8"

  
# ==============================
# LOGGERS
# ==============================

# Root logger configuration.
# This serves as the default logger for any unhandled log messages.
root:
  level: DEBUG                     # Minimum level: INFO (excludes DEBUG)
  handlers: [console_handler, audit_file_handler, error_file_handler]
  propagate: false

# Application-specific loggers organized by component.
loggers:  
  # Main application logger for business logic and core operations.
  # Use this logger for application-level events an business processes.
  app:
    level: INFO
    handlers: [console_handler, audit_file_handler, error_file_handler]
    propagate: false

  # Session management logger for user session events.
  session:
    level: DEBUG
    handlers: [console_handler, audit_file_handler, error_file_handler]
    propagate: false

  # Uvicorn ASGI server logger for HTTP requests, responses, and server events.
  # Configured separately to isolate web server logs from application logs.
  uvicorn:
    level: INFO
    handlers: [uvicorn_console_handler, audit_file_handler]
    propagate: false